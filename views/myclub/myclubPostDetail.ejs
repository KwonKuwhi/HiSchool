<!DOCTYPE html>
<html lang="ko">

<head>
   <!-- 생략 (head 내용) -->

   <!-- axios CDN -->
   <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
   <%- include('../component/header') %>
      <div class="board">
         <!-- 게시글 세부 내용 -->
         <div class="post-detail">
            <h2>
               <%= data.title %>
            </h2>
            <p>
               <%= data.content %>
            </p>
            <!-- 게시글 작성 시간 등의 메타 정보도 추가 있습니다. -->
         </div>

         <button class="btn btn-primary" onclick="editPost('<%= data.post_id %>')">수정</button>


         <div class="comment-section">
            <input type="text" id="commentInput" placeholder="댓글을 입력하세요">
            <button onclick="submitComment()">등록</button>
         </div>

         <!-- 댓글 들어갈곳 -->
         <div class="list" id="commentList"></div>

         <button onclick="patchPostComment()">댓글수정</button>
         <button onclick="deletePostComment()">댓글삭제</button>


         <script>
            const club_id = "<%=data.club_id%>";
            const post_id = "<%=data.post_id%>";


            function submitComment() {
               const commentContent = document.getElementById('commentInput').value;
               const requestData = {
                  comment_name: "test", // 예시 데이터
                  content: commentContent
               };
               console.log("보내는 데이터:", requestData);

               axios({
                  method: 'post',
                  url: `/myclubPostDetail/${club_id}/${post_id}/`,
                  data: {
                     comment_name: "test", // 예시 데이터
                     content: commentContent
                  }
               })
                  .then(res => {
                     console.log(`club_id:${club_id}`);
                     console.log(`post_id:${post_id}`);
                     console.log("댓글 등록 완료");
                     console.log(`받는 데이터`, res.data);

                     // 새로운 댓글을 목록에 추가
                     const commentList = document.getElementById('commentList');
                     const newCommentDiv = document.createElement('div');
                     newCommentDiv.classList.add('comment');
                     newCommentDiv.innerHTML = `
                     <p>${res.data.comment_name}</p>
                     <p>${res.data.content}</p>
                  `;
                     commentList.appendChild(newCommentDiv);

                     // 입력 필드 초기화
                     document.getElementById('commentInput').value = '';
                  })
                  .catch(error => {
                     console.error("댓글 등록 에러:", error);
                  });
            }

            // 기존의 patchPostComment 및 deletePostComment 함수
         </script>
</body>

</html>